<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Client/Server Side</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
				<!-- <link href="main.css" rel="stylesheet" type="text/css" /> -->
				<link rel="icon" type="image/png" href="img/favicon.png" />
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
				<link rel="stylesheet" href="css/style.css"/>
        
		
	<style>
							body {
										background-repeat:no-repeat;
										background-color:#eee;
										font:14px/1.3 Arial,sans-serif;
										background-image:url(../img/bg1.gif);
										background-repeat: repeat;
							}
							div#chat {
										position: fixed;
										left: 36%;
										border: 1px solid #888;
										color: #000;
										padding: 10px;
										width: 625px;
										height:300px;
										bottom:0px;
										overflow: scroll;
							}

							div#peerZone {
										position: fixed;
										left: 0%;
										border: 1px solid #888;
										color: #000;
										padding: 10px;
										width: 300px;
										height:200px;
										bottom:0px;
										overflow: scroll;
							}

							div#righColumn {
										position:fixed;
										bottom: 0;
										left:70%;
										width: 50%;
							}
							div#chat div#conversation {
										width: 610px;
										background-color: #c0c0c0;
										border: 1px solid #888;
										overflow: auto;
										color: #000;
							}
							div#chat input#data {
										background-image: url(img/ico.jpg);
										text-indent: 20px;
										background-repeat: no-repeat;
										background-size: 20px;
										background-position: 0px 1px;
										margin: 5px;
										width: 530px;
							}
							div#map
							{
										left:0px;
										width:400px;
										height:290px;
										buttom:0px;
										border:1px solid gray;
							}
							div#drag{
										border:1px solid gray;
										position:absolute;
										height:300px;
										width:450px;
										overflow: auto;
							}
							/* chat block */
							.chat_messages .message {
										background-color: #fff;
										margin: 2px;
										padding: 5px;
										-moz-border-radius: 5px;
										-ms-border-radius: 5px;
										-o-border-radius: 5px;
										-webkit-border-radius: 5px;
										border-radius: 5px;
									
							}
							.chat_messages .message span {
										color: #444;
										font-size: 10px;
										margin-left: 10px;
							}
							#data, #datasend, #afficher,#afficherSharing, #drop{
										-moz-border-radius: 5px;
										-ms-border-radius: 5px;
										-o-border-radius: 5px;
										-webkit-border-radius: 5px;
										border-radius: 5px;
										border-style: groove;
							}
							#data {
										border-style: groove;
										font-size: 16px;
										height: 25px;
										margin-right: 10px;
										width: 200px;
							}
							#datasend, #afficher,#, #drop{
										cursor: pointer;
										font-size: 16px;
										font-weight: bold;
										height: 35px;
										padding: 5px;
							}
							#listofUsers{
										border-left: 1px solid rgba(0, 0, 0, 0.4);
										box-shadow: 2px 0 2px -2px #B2B9C9 inset;
										background-image:url(../img/bg1.gif);
										background-repeat: repeat;
										color: #333333;
										display: block;
										height: 100%;
										padding: 10px;
										position: fixed;
										right: 0;
										top: 0;
										width: 200px;
										z-index: 101;
										overflow: hidden;
										display: block;
							}
							#otherClients {
									height:50px;
									/*overflow-y:scroll;*/
						    }
						    #selfVideo {
									height:100%;
									width:100%;
									/*float:left;*/
									border:1px solid gray;
									/*margin-left:10px;*/
						    }
						    .callerVideo {
									height:140px;
									width:200px;
									border:1px solid gray;
									/*margin-left:10px;*/
						    }
						    #videos{
								display: flexbox;
								flex-direction: column;
								flex-pack:center;
						    }
							#con3.container {
										margin-left: auto;
										margin-right: auto;
										width: 800px;
										height:600px;
							}

							.alert img {
		                				float:left;
		                		padding-right: 10px;
            				}
            				.peerblock {
				                width: 800px;
				                border-radius:2px;
				                border:1px solid gray;
				            }

				            .receiveBlock {
				                width: 500px;
				                margin:10px;
				                display: inline-block;
				            }
				            .dragndrop {
				                display: inline-block;
				                padding:2em;
				                margin: 2px;
				                border:2px solid black;
				                border-radius: 5px;
				            }
				            .dragndropStatus {
				                display: inline-block;
				            }
				            .connecting {
				                background-color: yellow;
				            }
				            .usesSockets {
				                background-color: pink;
				            }
				            .notConnected {
				                visibility:hidden;
				            }
				            .connected {
				                background-color: #e0ffe0;
				            }
				            .notConnected:hover {
				                margin: 1px;
				                border-width: 3px;
				            }
				            .connected:hover {
				                margin: 1px;
				                border-width:3px;
				            }
				            .connectButton {
				                padding:2em;
				            }
        </style>
        
        <!-- scripts used for video-conferencing -->
        <script src="js/jquery-1.7.2.min.js"></script>
        <script src="js/socketio.js"> </script>
        <script src="js/RTCPeerConnection.js"> </script>
        <script src="js/chat.js"></script>
        <script src="js/zepto.min.js"></script>
				<script src="js/script.js"></script>
				<script src="js/socket.io.js"></script>
				<script type="text/javascript" src="js/easyrtc.js"></script>
				<script type="text/javascript" src="js/demo_audio_video_simple.js"></script>
				<script src="http://code.jquery.com/jquery-latest.min.js"></script>
        <script src="http://maps.google.com/maps/api/js?sensor=false"></script>
        <!--Initialisation de la map-->
        <script type="text/javascript">
            $( document ).ready(function() {
                chat=new chat();
                chat.initializeSocket();
                chat.loadPage();
            });
        </script>

        <script type="text/javascript" src="js/easyrtc_ft.js"></script>
        <script type="text/javascript" src="js/DataSharing.js"></script>
    </head>

    <!-- <body onload="connectVideo(document.URL.substring(1).split('/')[4]);connectData();alert(document.URL.substring(1).split('/')[4])"> -->

	<body onload="connectData(document.URL.substring(1).split('/')[4]);">
        <article>
					<script>
					$(document).ready(function(){
						//var req = new XMLHttpRequest();
						//var headers = req.getAllResponseHeaders().toLowerCase();
						//alert(headers);


						//$("#chat").hide();
						$("#afficher").click(function(){
							if ($("#chat").is(":hidden")) {
									$(this).next("#chat").slideToggle(600);
									$("#afficher").prop('value', '-');
							} 
							else {
									$(this).next("#chat").slideToggle(600);
									$("#afficher").prop('value', '+');
							}
						});

						$("#afficherSharing").click(function(){
							if ($("#chat").is(":hidden")) {
									$(this).next("#peerZone").slideToggle(600);
									$("#afficherSharing").prop('value', '-');
							} 
							else {
									$(this).next("#peerZone").slideToggle(600);
									$("#afficherSharing").prop('value', '+');
							}
						});
					})
					
					
					
					
					



					
					</script>
            <script>
                var config = {
                    openSocket: function(config) {
                        var SIGNALING_SERVER = '/',
                            defaultChannel = location.hash.substr(1) || 'video-conferencing-hangout';

                        var channel = config.channel || defaultChannel;
                        var sender = Math.round(Math.random() * 999999999) + 999999999;

                        io.connect(SIGNALING_SERVER).emit('new-channel', {
                            channel: channel,
                            sender: sender
                        });

                        var socket = io.connect(SIGNALING_SERVER + channel);
                        socket.channel = channel;
                        socket.on('connect', function() {
                            if (config.callback) config.callback(socket);
                        });

                        socket.send = function(message) {
                            socket.emit('message', {
                                sender: sender,
                                data: message
                            });
                        };

                        socket.on('message', config.onmessage);
                    },
                   };

            </script>
        </article>
        <div id="drag">
					<form id="upload" enctype="multipart/form-data">
					<div id="drop-area">Glisser-déposer des fichiers</div>
					<label for="files-upload">ou parcourir le disque
					<input id="files-upload" type="file" multiple="multiple"/>
					</label>
					</form>
					<ul id="waiting-list"></ul>
					<ul id="file-list"></ul>
				</div>

				<div class="container" id="con3" style="height:300px; width:300px; margin-left:auto; margin-right:auto;">
         	<video autoplay="autoplay" class="easyrtcMirror" class="callerVideo" id="selfVideo" style="height:300px; width:550px; " muted="muted" volume="0" ></video>
				</div>
					<input type="button" id="afficher" value="+" />
					
					

					<div id="chat">
					<div id="rectangle"></div>
						<div class="chat_messages">
							<div id="conversation"></div>
							<input type ="text" id="data"/>
							<input type="button" id="datasend" value="send" />
						</div>
					</div>
				
				
        
            <div id="listofUsers">
                <b><H2><center>USERS</center></h2></b>
								<div class="profiles">
									<div id="users"></div>
								</div><br/>
							<div id="iam">Not yet connected...</div>
							

							<section id="videos">
								<video autoplay="autoplay" class="callerVideo"  id="callerVideo1" style="flex-order: 1"></video>
								<video autoplay="autoplay" class="callerVideo"  id="callerVideo2" style="flex-order: 2"></video>
								<video autoplay="autoplay" class="callerVideo"  id="callerVideo3" style="flex-order: 3"></video>
							</section>
            </div>
						<!--<b><H2>My Localisation</h2></b>-->
						<br/><br/>
            <div id="map">

            </div>


            <input type="button" id="afficherSharing" value="+" />

            <div id="peerZone"></div>


    </body>
</html>
